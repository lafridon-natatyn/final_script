# Финальная работа по специализации Machine Learning Engineer

Задачей ML-инженера в данной работе является создание модели, предсказывающей, сделает ли пользователь с определенными параметрами целевое действие — события типа «Оставить заявку» и «Заказать звонок» в сервисе "Сберавтоподписка"

**Цель работы:**
1. Научиться предсказывать совершение целевого действия
(ориентировочное значение ROC-AUC ~ 0.65) — факт совершения
пользователем целевого действия.
2. Упаковать получившуюся модель в сервис, который будет брать на
вход все атрибуты, типа utm_*, device_*, geo_*, и отдавать на выход
0/1 (1 — если пользователь совершит любое целевое действие).


**План работы:**

1) Произвести разведочный анализ данных - провести базовую чистку (дубликаты, пустые значения, ненужные атрибуты).
2) Сделать Feature Engineering - сгенерировать новые признаки, если это необходимо, преобразовать данные для дальнейшего моделирования
3) Прроизвести моделирование с помощью нескольких алгоритмов и выбрать наилучшую модель исходя из метрики ROC-AUC. Ее значение должно превысить 0.65
4) Упаковать полученную модель в пайплайн, создав скрипт .py
5) Создать сервис в localhost web-приложении с помощью фреймворка Fast API

**Описание данных**

**GA Sessions (ga_sessions.csv)**

*session_id*: ID визита;

*client_id*: ID посетителя;

*visit_date*: дата визита;

*visit_time*: время визита;

*visit_number*: порядковый номер визита клиента;

*utm_source*: канал привлечения;

*utm_medium*: тип привлечения;

*utm_campaign*: рекламная кампания;

*utm_keyword*: ключевое слово;

*device_category*: тип устройства;

*device_os*: ОС устройства;

*device_brand*: марка устройства;

*device_model*: модель устройства;

*device_screen_resolution*: разрешение экрана;

*device_browser*: браузер;

*geo_country*: страна;

*geo_city*: город.

**GA Hits (ga_hits.csv)**

*session_id*: ID визита;

*hit_date*: дата события;

*hit_time*: время события;

*hit_number*: порядковый номер события в рамках сессии;

*hit_type*: тип события;

*hit_referer*: источник события;

*hit_page_path*:страница события;

*event_category*: тип действия;

*event_action*: действие;

*event_label*: тег действия;

*event_value*: значение результата действия.






# Click prediction model

Финальная работа по курсу "Введение в Data Science"


## Installation
Необходима установленная библиотека Fast API

1) Скачать с Google Drive файлы ga_hits.csv и  ga_sessions.csv ссылка: https://drive.google.com/drive/folders/1rA4o6KHH-M2KMvBLHp5DZ5gioF2q7hZw
и положить их по пути ~\final_script\model\data
2) По пути ~\final_script\model запустить скрипт pipeline_one_model.py для получения файла обученной модели sberautopodpiska.pkl
3) С помощью терминала необходимо зайти по пути ~\final_script\ и с помощью команды uvicorn main:app --reload запустить веб-сервер. Адрес будет http://127.0.0.1:8000/

## Work

1) С помощью сервиса Postman по адресу http://127.0.0.1:8000/ отправить GET запросы /status и /version для проверки соединения и POST запрос /predict с содержимым  JSON файла 7310993818.json для проверки работы самой модели и получения предсказания клика по данным, содержавшимся в JSON файле

